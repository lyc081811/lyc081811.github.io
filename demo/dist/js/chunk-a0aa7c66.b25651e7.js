(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a0aa7c66"],{"0bd3":function(t,e,a){"use strict";var s=a("0ddb"),o=a.n(s);o.a},"0ddb":function(t,e,a){},"1b51":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[t._m(0),a("div",{staticStyle:{flex:"1",overflow:"hidden",display:"flex","flex-direction":"column"}},[a("div",{staticClass:"peopleData"},[a("div",{staticClass:"propleSearch"},[a("el-input",{staticClass:"arcRadius",staticStyle:{width:"150px"},attrs:{placeholder:"姓名/卡号/首字母"},model:{value:t.searchParams.condition,callback:function(e){t.$set(t.searchParams,"condition",e)},expression:"searchParams.condition"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),a("div",{staticClass:"searchItem",staticStyle:{display:"inline-block",margin:"0 16px"}},[a("el-select",{attrs:{placeholder:"评估结果"},on:{change:t.selChange},model:{value:t.searchParams.status,callback:function(e){t.$set(t.searchParams,"status",e)},expression:"searchParams.status"}},t._l(t.assessRst,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value,"filter-placement":"bottom-end"}},[t._v(t._s(e.name))])}),1)],1),a("div",{staticStyle:{display:"inline-block","margin-right":"16px"}},[a("el-date-picker",{attrs:{type:"datetimerange","picker-options":t.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:t.searchParams.dateRange,callback:function(e){t.$set(t.searchParams,"dateRange",e)},expression:"searchParams.dateRange"}})],1),a("el-button",{attrs:{type:"primary"},on:{click:t.getData}},[t._v("查询")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",align:"center"}}),a("el-table-column",{attrs:{label:"客户姓名",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{trigger:1==e.row.isCrisis?"hover":"manual",placement:"right"},on:{show:function(a){t.getAbnormal(e.row.orderCode)}}},[a("p",[t._v("危机值")]),t._l(t.abnormalData,function(e,s){return a("p",{key:s},[t._v(t._s(e.keys))])}),a("div",{staticClass:"name-wrapper",staticStyle:{position:"relative"},attrs:{slot:"reference"},slot:"reference"},[1==e.row.isCrisis?a("i",{staticClass:"iconfont",staticStyle:{color:"#F56C6C",position:"absolute",left:"-10px"}},[t._v("")]):t._e(),a("span",[t._v(t._s(e.row.customerName))])])],2)]}}])}),a("el-table-column",{attrs:{property:"customerGender",label:"性别",width:"120",align:"center",sortable:!0}}),a("el-table-column",{attrs:{property:"age",label:"年龄",width:"120",align:"center",sortable:!0}}),a("el-table-column",{attrs:{property:"cardNum",label:"体检卡号",width:"120",align:"center",sortable:!0}}),a("el-table-column",{attrs:{property:"idCardNum",label:"身份证号",width:"120",align:"center"}}),a("el-table-column",{attrs:{property:"unitName",label:"单位名称",align:"center"}}),a("el-table-column",{attrs:{property:"deptName",label:"部门",align:"center"}}),a("el-table-column",{attrs:{property:"teamName",label:"组别",align:"center"}}),a("el-table-column",{attrs:{property:"checkBeginTime",label:"体检开始时间",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatDate")(e.row.checkBeginTime,"YYYY-MM-DD")))]}}])}),a("el-table-column",{attrs:{property:"summaryFinishTime",label:"报告回传时间",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t._f("formatDate")(e.row.summaryFinishTime,"YYYY-MM-DD"))+"\n        ")]}}])}),t.showState?a("el-table-column",{attrs:{label:"驳回",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.isReject?a("i",{staticClass:"iconfont",staticStyle:{color:"#F56C6C"}},[t._v("")]):t._e()]}}])}):t._e(),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:t.caozuowidth,align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==t.strobj?a("el-button",{attrs:{type:"text"},on:{click:function(a){t.lock(e.$index,e.row)}}},[t._v("锁定")]):2==t.strobj?a("div",[a("el-button",{attrs:{type:"text"},on:{click:function(a){t.unlock(e.$index,e.row)}}},[t._v("解锁")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){t.auditing(e.$index,e.row)}}},[t._v("评估")])],1):a("div",[a("el-button",{attrs:{type:"text"},on:{click:function(a){t.see(e.row,!0)}}},[t._v("查看")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){t.withdraw(e.$index,e.row)}}},[t._v("撤回")])],1)]}}])})],1),a("div",{staticClass:"fixBottom"},[a("div",{staticClass:"right"},[a("el-pagination",{staticStyle:{display:"inline-block","text-align":"right"},attrs:{"current-page":t.searchParams.pageIndex,"page-sizes":[10,15,20,30,50,100],layout:"sizes, prev, pager, next, jumper","page-count":t.pageNum},on:{"current-change":t.handleCurrentChange,"size-change":t.sizeChange}})],1)])],1)])},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"topTitle"},[a("span",[t._v("主检评估")])])}],n=(a("7f7f"),a("c1df")),r=a.n(n),i={name:"PGMain",data:function(){return{assessRst:[],searchParams:{dateRange:[r()().subtract(1,"years").format("YYYY-MM-DD"),r()().format("YYYY-MM-DD")],condition:"",status:0,masterCode:"001",pageSize:10,pageIndex:1},showState:!1,loading:!1,pageNum:1,caozuowidth:"80px",strobj:0,total:0,tableData:[],abnormalData:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},operatorCode:"001"}},created:function(){this.getData(),this.getAssessRstType()},methods:{sizeChange:function(t){this.searchParams.pageSize=t,this.getData()},handleCurrentChange:function(t){this.searchParams.pageIndex=t,this.getData()},selChange:function(t){this.getData()},getData:function(){var t=this;this.loading=!0,this.$axios.post(this.$api.GetPGUserLstByCondition,this.searchParams).then(function(e){1===e.data.status?(t.tableData=e.data.entity.item1,t.total=e.data.entity.item2,t.pageNum=Math.ceil(t.total/t.searchParams.pageSize),t.strobj=t.searchParams.status,0==t.searchParams.status?(t.caozuowidth="80px",t.showState=!1):2==t.searchParams.status?(t.caozuowidth="150px",t.showState=!0):(t.caozuowidth="150px",t.showState=!1)):t.$message.error(e.data.message),t.loading=!1}).catch(function(e){t.loading=!1,console.log(e)})},getAssessRstType:function(){var t=this;this.$axios.post(this.$api.GetAssessRstType).then(function(e){200===e.status&&1===e.data.status&&(t.assessRst=e.data.entity)})},lock:function(t,e){var a=this,s=this;this.$axios.post(this.$api.IsLockPGUserByOrderCode,{OrderCode:e.orderCode,OperatorCode:this.operatorCode}).then(function(t){var o=t.data;1==o.status?o.entity?s.$message.warning(o.message+"请刷新页面"):a.notlocked(e):s.$message.error(t.data.message)}).catch(function(t){console.error(t.message)})},notlocked:function(t){var e=this;this.$axios.post(this.$api.LockPGUser,{OrderCode:t.orderCode,OperatorCode:this.operatorCode}).then(function(a){1==a.data.status&&a.data.entity?e.$axios.post(e.$api.IsHasPgMasterRstDetailByOrderCode,{OrderCode:t.orderCode,OperatorCode:e.operatorCode}).then(function(s){1==a.data.status?e.proposalChoice(a.data.entity,t):e.$message.error(a.data.message)}).catch(function(t){console.error(t.message)}):e.$message.error(a.data.message)}).catch(function(t){console.log(t.message)})},proposalChoice:function(t,e){var a=this;t?this.$confirm("该条数据已存在医学指导建议，是否重新生成?","提示",{confirmButtonText:"重新生成",cancelButtonText:"不生成",dangerouslyUseHTMLString:!0,closeOnClickModal:!1,type:"warning"}).then(function(){a.aginProposal(e)}).catch(function(){a.notProposal(e)}):this.doProposal(e)},doProposal:function(t){var e=this;this.$axios.post(this.$api.LockPGUserOperatorHasGuidance,{OrderCode:t.orderCode,OperatorCode:this.operatorCode}).then(function(a){1==a.data.status&&a.data.entity?(e.$message.success("生成成功。"),e.see(t,!1)):e.$message.error(a.data.message)}).catch(function(t){console.error(t.message)})},aginProposal:function(t){var e=this;this.$axios.post(this.$api.GenerateMedicalGuidancesByOrderCode,{OrderCode:t.orderCode,OperatorCode:this.operatorCode}).then(function(a){1==a.data.status&&a.data.entity?(e.$message.success("重新生成成功。"),e.see(t,!1)):e.$message.error(a.data.message)}).catch(function(t){console.error(t.message)})},notProposal:function(t){var e=this;this.$axios.post(this.$api.LockPGUserOperatorNotHasGuidance,{OrderCode:t.orderCode,OperatorCode:this.operatorCode}).then(function(a){1==a.data.status&&a.data.entity?e.see(t,!1):e.$message.error(a.data.message)}).catch(function(t){console.error(t.message)}),this.getData()},unlock:function(t,e){var a=this,s=this;this.$confirm('<span>该用户将会进入未评估列表！</span><br /><i style="color:#8F9399;">请去未评估列表寻找该客户。</i>',"提示",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,closeOnClickModal:!1,type:"warning"}).then(function(){a.$axios.post(a.$api.UnLockPGUser,{OrderCode:e.orderCode,OperatorCode:a.operatorCode}).then(function(t){var e=t.data;1==e.status?e.entity?(s.$message.success("解锁成功"),a.searchParams.status=0,a.getData()):a.openNotify("解锁失败",e.message):s.$message.error(t.data.message)}).catch(function(t){console.error(t.message)})}).catch(function(){})},auditing:function(t,e){this.see(e,!1)},withdraw:function(t,e){var a=this,s=this;this.$confirm('<span>该用户将会进入评估中列表！</span><br /><i style="color:#8F9399;">请去评估中列表寻找该客户</i>',"提示",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,closeOnClickModal:!1,type:"warning"}).then(function(){a.$axios.post(a.$api.RevokePGUser,{OrderCode:e.orderCode,OperatorCode:a.operatorCode}).then(function(t){var e=t.data;1==e.status?e.entity?(s.$message.success("撤回成功"),a.searchParams.status=2,a.getData()):a.openNotify("撤回失败",e.message):s.$message.error(t.data.message)}).catch(function(t){console.error(t.message)})}).catch(function(){})},see:function(t,e){var a=e?"查看中，请稍候":"评估中，请稍候",s=this.$loading({lock:!0,text:a});this.$router.push({path:"/pg/pgmodal",query:{rowData:t,parentName:this.$options.name,operatorCode:this.operatorCode,isDisabled:e}}),s.close()},openNotify:function(t,e){var a=this.$createElement;this.$notify({title:t,message:a({style:"color: teal"},e)})},getAbnormal:function(t){var e=this;this.$axios.post(this.$api.GetCrisisFjRstAbnormalsByOrderCode,{OrderCode:t}).then(function(t){1==t.data.status?e.abnormalData=t.data.entity:e.$message(t.data.message)}).catch(function(t){})}}},c=i,l=(a("0bd3"),a("2877")),d=Object(l["a"])(c,s,o,!1,null,null,null);d.options.__file="PGMain.vue";e["default"]=d.exports}}]);