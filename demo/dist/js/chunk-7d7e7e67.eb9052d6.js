(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d7e7e67"],{"736e":function(e,t,a){},"84c4":function(e,t,a){"use strict";var i=a("736e"),s=a.n(i);s.a},fd57:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content SFFPManage"},[a("div",{staticStyle:{flex:"1",overflow:"hidden",display:"flex","flex-direction":"column"}},[a("el-tabs",{on:{"tab-click":e.tabsClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"未使用",name:"first"}},[a("div",{staticClass:"peopleData"},[a("div",{staticClass:"propleSearch"},[a("el-input",{staticClass:"arcRadius",staticStyle:{width:"150px"},attrs:{placeholder:"请搜索"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getData(0,!0)}},model:{value:e.params1.Content,callback:function(t){e.$set(e.params1,"Content",t)},expression:"params1.Content"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),a("div",{staticStyle:{display:"inline-block",margin:"0 16px"}},[a("span",[e._v("入库时间：")]),a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.time1,callback:function(t){e.time1=t},expression:"time1"}})],1),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.getData(0,!0)}}},[e._v("查询")]),a("div",{staticClass:"right"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("发票入库")]),a("el-button",{attrs:{type:"warning"},on:{click:e.invalid}},[e._v("发票作废")])],1)],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading1,expression:"loading1"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData1},on:{"selection-change":e.handleSelectionChange,"row-click":function(t){e.clickRow(t,"table")}}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"invoiceNum",label:"发票号"}}),a("el-table-column",{attrs:{prop:"createTime",label:"入库时间",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatDate")(t.row.createTime)))]}}])}),a("el-table-column",{attrs:{prop:"operator",label:"操作人"}})],1),a("div",{staticClass:"fixBottom"},[a("div",{staticClass:"right"},[a("el-pagination",{attrs:{layout:"total,sizes, prev, pager, next, jumper",total:e.total[0],"page-sizes":[10,20,50,100],"current-page":e.searchParams1.PageIndex},on:{"current-change":e.handleCurrentChange1,"size-change":e.handleSizeChange1}})],1)]),a("el-dialog",{attrs:{title:"发票入库",visible:e.dialogFormVisible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.invoiceData,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"开始发票号",prop:"beginNum"}},[a("el-input",{model:{value:e.invoiceData.beginNum,callback:function(t){e.$set(e.invoiceData,"beginNum",t)},expression:"invoiceData.beginNum"}})],1),a("el-form-item",{attrs:{label:"结束发票号",prop:"endNum"}},[a("el-input",{model:{value:e.invoiceData.endNum,callback:function(t){e.$set(e.invoiceData,"endNum",t)},expression:"invoiceData.endNum"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1,e.resetForm("form")}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.invoiceInitialization}},[e._v("确 定")])],1)],1)],1),a("el-tab-pane",{attrs:{label:"已使用",name:"second"}},[a("div",{staticClass:"peopleData"},[a("div",{staticClass:"propleSearch"},[a("el-input",{staticClass:"arcRadius",staticStyle:{width:"150px"},attrs:{placeholder:"请搜索"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getData(1,!0)}},model:{value:e.params2.Content,callback:function(t){e.$set(e.params2,"Content",t)},expression:"params2.Content"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),a("el-select",{attrs:{placeholder:"发票状态"},model:{value:e.params2.InvoiceStatus,callback:function(t){e.$set(e.params2,"InvoiceStatus",t)},expression:"params2.InvoiceStatus"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._l(e.options[0],function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})],2),a("el-select",{attrs:{placeholder:"时间类型"},model:{value:e.params2.DateType,callback:function(t){e.$set(e.params2,"DateType",t)},expression:"params2.DateType"}},e._l(e.options[1],function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1),a("div",{staticStyle:{display:"inline-block",margin:"0 16px"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.time2,callback:function(t){e.time2=t},expression:"time2"}})],1),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.getData(1,!0)}}},[e._v("查询")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading2,expression:"loading2"}],staticStyle:{width:"100%"},attrs:{data:e.tableData2}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),a("el-table-column",{attrs:{prop:"invoiceNum",label:"发票号",sortable:""}}),a("el-table-column",{attrs:{prop:"invoiceMoney",label:"发票金额",sortable:""}}),a("el-table-column",{attrs:{prop:"accountName",label:"发票抬头"}}),a("el-table-column",{attrs:{label:"发票状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("invoiceState")(t.row.invoiceState)))]}}])}),a("el-table-column",{attrs:{prop:"usedTime",label:"时间",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[2===t.row.invoiceState?a("span",[e._v(e._s(e._f("formatDate")(t.row.usedTime)))]):e._e(),3===t.row.invoiceState||4===t.row.invoiceState?a("span",[e._v(e._s(e._f("formatDate")(t.row.recoverTime)))]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"operator",label:"经手人"},scopedSlots:e._u([{key:"default",fn:function(t){return[2===t.row.invoiceState?a("span",[e._v(e._s(t.row.usedName))]):e._e(),3===t.row.invoiceState||4===t.row.invoiceState?a("span",[e._v(e._s(t.row.recoverName))]):e._e()]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[2==t.row.invoiceState?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.openModal(t.row)}}},[e._v("重开发票")]):e._e()]}}])})],1),a("div",{staticClass:"fixBottom"},[a("div",{staticClass:"right"},[a("el-pagination",{attrs:{layout:"total,sizes, prev, pager, next",total:e.total[1],"page-sizes":[10,20,50,100],"current-page":e.searchParams2.PageIndex},on:{"current-change":e.handleCurrentChange2,"size-change":e.handleSizeChange2}})],1)]),a("el-dialog",{attrs:{title:"重开发票",visible:e.chargeDialog,width:"720px","close-on-click-modal":!1},on:{"update:visible":function(t){e.chargeDialog=t}}},[a("div",{staticClass:"modal-title"},[e._v("客户信息")]),a("div",{staticClass:"modal-con"},[a("ul",[a("li",{staticClass:"item"},[a("span",[e._v("金额：")]),a("div",{staticClass:"item-list",staticStyle:{color:"#F56C6C","font-size":"14px"}},[e._v("￥"+e._s(e.reOpen.invoiceMoney)+"元")])]),a("li",{staticClass:"item"},[a("span",[e._v("发票号：")]),a("div",{staticClass:"item-list"},[e._v(e._s(e.reOpen.newInvoice))])]),a("li",{staticClass:"item"},[a("span",[e._v("抬头：")]),a("div",{staticClass:"item-list"},[a("el-input",{model:{value:e.reOpen.accountName,callback:function(t){e.$set(e.reOpen,"accountName",t)},expression:"reOpen.accountName"}})],1)])])]),a("div",{staticClass:"modal-title"},[e._v("缴费历史")]),a("div",{staticClass:"modal-con"},e._l(e.reOpen.tradeHistory,function(t,i){return a("ul",{key:i},[a("li",{staticClass:"item"},[a("span",[e._v("缴费方式：")]),a("div",{staticClass:"item-list"},[e._v(e._s(e._f("tradetype")(t.tradeType)))])]),a("li",{staticClass:"item"},[a("span",[e._v("缴费金额：")]),a("div",{staticClass:"item-list"},[e._v("￥"+e._s(t.tradeMoney)+"元")])])])}),0),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.chargeDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.invoiceReopen}},[e._v("确 定")])],1)])],1)],1)],1)])},s=[],n=(a("ac6a"),a("c5f6"),a("7f7f"),a("c1df")),o=a.n(n),r={name:"SFFPManage",data:function(){return{loading1:!1,loading2:!1,tableData1:[],tableData2:[],time1:[o()().subtract(1,"week").format(),o()().format()],time2:[o()().subtract(1,"week").format(),o()().format()],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},options:[],total:[],dialogFormVisible:!1,chargeDialog:!1,activeName:"first",params1:{time1:[o()().subtract(1,"week").format(),o()().format()],Content:""},params2:{time2:[o()().subtract(1,"week").format(),o()().format()],DateType:2,Content:""},searchParams1:{BeginTime:"",EndTime:"",Content:"",PageIndex:1,PageSize:10,IsUsed:1,DateType:1},searchParams2:{BeginTime:"",EndTime:"",Content:"",InvoiceStatus:"",PageIndex:1,PageSize:10,DateType:2,IsUsed:2},invoiceData:{endNum:"",beginNum:"",operatorCode:"001"},rules:{beginNum:[{required:!0,message:"请输入开始发票号",trigger:"change"},{pattern:/^[0-9]*$/,message:"发票号必须为正整数",trigger:"blur"}],endNum:[{required:!0,message:"请输入结束发票号",trigger:"change"},{pattern:/^[0-9]*$/,message:"发票号必须为正整数",trigger:"blur"}]},selection:[],reOpen:{accountName:"",oldInvoice:"",newInvoice:"",tradeHistory:[]}}},created:function(){this.getData(0,!0),this.getOptions()},methods:{tabsClick:function(e,t){"second"===e.name&&0===this.tableData2.length&&this.getData(1,!0)},handleCurrentChange1:function(e){this.searchParams1.PageIndex=e,this.getData(0)},handleSizeChange1:function(e){this.searchParams1.PageSize=e,this.searchParams1.PageIndex=1,this.getData(0)},handleCurrentChange2:function(e){this.searchParams2.PageIndex=e,this.getData(1)},handleSizeChange2:function(e){this.searchParams2.PageSize=e,this.searchParams2.PageIndex=1,this.getData(1)},getData:function(e,t){var a=this,i={};0==e?(this.loading1=!0,this.tableData1=[],t?(this.time1&&2===this.time1.length?(this.searchParams1.BeginTime=o()(this.time1[0]).format("YYYY-MM-DD"),this.searchParams1.EndTime=o()(this.time1[1]).format("YYYY-MM-DD")):(this.searchParams1.BeginTime="",this.searchParams1.EndTime=""),this.searchParams1.Content=this.params1.Content,this.params1.time1=this.time1,this.searchParams1.PageIndex=1):(this.time1=this.params1.time1,this.params1.Content=this.searchParams1.Content),i=this.searchParams1):1==e&&(this.tableData2=[],this.loading2=!0,t?(this.time2&&2===this.time2.length?(this.searchParams2.BeginTime=o()(this.time2[0]).format("YYYY-MM-DD"),this.searchParams2.EndTime=o()(this.time2[1]).format("YYYY-MM-DD")):(this.searchParams2.BeginTime="",this.searchParams2.EndTime=""),this.searchParams2.Content=this.params2.Content,this.searchParams2.DateType=this.params2.DateType,this.searchParams2.InvoiceStatus=this.params2.InvoiceStatus,this.params2.time2=this.time2,this.searchParams2.PageIndex=1):(this.time2=this.params1.time2,this.params2.Content=this.searchParams2.Content,this.params2.DateType=this.searchParams2.DateType,this.params2.InvoiceStatus=this.searchParams2.InvoiceStatus),i=this.searchParams2),this.$axios.get(this.$api.InvoiceQuery,{params:i}).then(function(t){t.data.entity&&1===t.data.status?(0==e?(a.loading1=!1,a.tableData1=t.data.entity.invoiceMessages):(a.loading2=!1,a.tableData2=t.data.entity.invoiceMessages),a.total[e]=t.data.entity.dataNum):(a.loading1=!1,a.loading2=!1,a.$message.error(t.data.message))}).catch(function(e){a.$message.error(e.data.message),a.loading1=!1,a.loading2=!1})},getOptions:function(){var e=this;this.$axios.get(this.$api.ReturnInvoiceStateEnum).then(function(t){200===t.status&&1===t.data.status&&(e.options[0]=t.data.entity)}),this.$axios.get(this.$api.ReturnInvoiceDateEnum).then(function(t){200===t.status&&1===t.data.status&&(e.options[1]=t.data.entity)})},handleSelectionChange:function(e){this.selection=e},resetForm:function(e){this.$refs[e].resetFields()},invoiceInitialization:function(){var e=this;Number(this.invoiceData.endNum)<Number(this.invoiceData.beginNum)?this.$message({type:"error",message:"结束发票号应不小于开始发票号"}):this.$refs.form.validate(function(t){if(!t)return!1;e.$axios.get(e.$api.InvoiceInitialization,{params:e.invoiceData}).then(function(t){e.dialogFormVisible=!1,200==t.status&&1==t.data.status?(e.$message.success("发票入库成功"),e.getData(0),e.$refs.form.resetFields()):e.$message.error(t.data.message)}).catch(function(t){e.$message.error(t.data.message)})})},invalid:function(){var e=this;0!==this.selection.length?this.$confirm('<p>确定对当前所选的发票进行作废处理吗？</p><span style="color: #8F9399;">作废后不可恢复，请谨慎操作</span>',"作废确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error",dangerouslyUseHTMLString:!0,closeOnClickModal:!1}).then(function(){var t={operatorCode:"001",invoiceNums:[]};e.selection.forEach(function(e){t.invoiceNums.push(e.invoiceNum)}),e.$axios.post(e.$api.InvoiceInvalid,t).then(function(t){1===t.data.status&&200===t.status?(e.$message({type:"success",message:"作废成功!"}),e.getData(0)):e.$message({type:"error",message:t.data.message})}).catch(function(e){})}).catch(function(){e.$message({type:"info",message:"已取消作废"})}):this.$message({type:"error",message:"请至少选择一项进行作废处理"})},openModal:function(e){this.reOpen.invoiceMoney=e.invoiceMoney,this.reOpen.accountName=e.accountName,this.reOpen.oldInvoice=e.invoiceNum,this.getMiniNum(),this.getHistory(e.invoiceNum),this.chargeDialog=!0},getHistory:function(e){var t=this;this.reOpen.tradeHistory=[],this.$axios.get(this.$api.TradeTypeQueryByInvoiceNum,{params:{invoiceNum:e}}).then(function(e){200===e.status&1===e.data.status?t.reOpen.tradeHistory=e.data.entity:t.$message({type:"error",message:e.data.message})}).catch(function(e){t.$message({type:"error",message:res.data.message})})},getMiniNum:function(){var e=this;this.$axios.get(this.$api.MINInvoiceQuery).then(function(t){200===t.status&&1===t.data.status?e.reOpen.newInvoice=t.data.entity:e.$message({type:"error",message:t.data.message})}).catch(function(t){e.$message({type:"error",message:res.data.message})})},invoiceReopen:function(){var e=this;if(this.reOpen.accountName){var t={oldInvoice:this.reOpen.oldInvoice,newInvoice:this.reOpen.newInvoice,accountName:this.reOpen.accountName,operatorCode:"001"};this.$axios.get(this.$api.InvoiceReopen,{params:t}).then(function(t){200===t.status&&1===t.data.status?(e.$message({type:"success",message:"重开发票成功"}),e.getData(2)):e.$message({type:"error",message:t.data.message})}).catch(function(t){e.$message({type:"error",message:res.data.message})}),this.chargeDialog=!1}else this.$message({type:"error",message:"请填写发票抬头"})}}},l=r,c=(a("84c4"),a("2877")),m=Object(c["a"])(l,i,s,!1,null,null,null);m.options.__file="SFFPManage.vue";t["default"]=m.exports}}]);