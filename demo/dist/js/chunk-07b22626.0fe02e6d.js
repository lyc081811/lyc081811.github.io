(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07b22626"],{"6baf":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content FJDanger"},[a("div",{staticStyle:{flex:"1",overflow:"hidden",display:"flex","flex-direction":"column"}},[a("div",{staticClass:"peopleData"},[a("div",{staticClass:"propleSearch"},[a("div",{staticStyle:{display:"inline"},on:{keyup:function(e){if(!("button"in e)&&13!==e.keyCode)return null;t.getUser()}}},[a("el-input",{staticClass:"arcRadius",staticStyle:{width:"150px"},attrs:{placeholder:"请搜索"},model:{value:t.keyStr,callback:function(e){t.keyStr=e},expression:"keyStr"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),a("el-select",{staticStyle:{width:"150px",display:"inline-block","margin-left":"10px"},attrs:{filterable:"",placeholder:"短信状态"},model:{value:t.sendFlag,callback:function(e){t.sendFlag=e},expression:"sendFlag"}},[a("el-option",{attrs:{label:"未发送",value:"0"}}),a("el-option",{attrs:{label:"已发送",value:"1"}}),a("el-option",{attrs:{label:"发送失败",value:"2"}})],1),a("el-select",{staticStyle:{width:"150px",display:"inline-block","margin-left":"10px"},attrs:{filterable:"",placeholder:"回访状态"},model:{value:t.visitState,callback:function(e){t.visitState=e},expression:"visitState"}},[a("el-option",{attrs:{label:"未回访",value:"false"}}),a("el-option",{attrs:{label:"已回访",value:"true"}})],1),a("div",{staticStyle:{display:"inline-block",margin:"0 16px"}},[a("el-date-picker",{staticClass:"input-class",attrs:{type:"datetimerange","picker-options":t.pickerOptions2,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",align:"right",size:"mini"},model:{value:t.tfDate,callback:function(e){t.tfDate=e},expression:"tfDate"}})],1),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.getUser()}}},[t._v("查询")])],1),a("div",{staticStyle:{display:"inline",float:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.sendMessage}},[t._v("发送短信")])],1)])]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,"default-sort":{prop:"date",order:"descending"}},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"userName",label:"姓名",width:"80"}}),a("el-table-column",{attrs:{prop:"telePhone",label:"电话号码",sortable:"",width:"200"}}),a("el-table-column",{attrs:{prop:"sex",label:"性别",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.sex?a("span",[t._v("男")]):a("span",[t._v("女")])]}}])}),a("el-table-column",{attrs:{prop:"cardNum",label:"体检卡号",sortable:"",width:"200"}}),a("el-table-column",{attrs:{prop:"crisisName",label:"危急值名称",width:"200"}}),a("el-table-column",{attrs:{prop:"smsContent",label:"短信内容",width:"200"}}),a("el-table-column",{attrs:{prop:"itemName",label:"来源项目",width:"200"}}),a("el-table-column",{attrs:{prop:"sendState",label:"短信状态",width:"200"}}),a("el-table-column",{attrs:{prop:"visitState",label:"回访状态",width:"200"}}),a("el-table-column",{attrs:{prop:"keyWord",label:"关键词",width:"200"}}),a("el-table-column",{attrs:{prop:"content",label:"结论",width:"200"}}),a("el-table-column",{attrs:{label:"操作",width:"150",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small",id:"jc"},on:{click:function(a){t.edit(e.row,e.$index)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text",size:"small",id:"jc"},on:{click:function(a){t.review(e.row,e.$index)}}},[t._v("回访")])]}}])})],1),a("div",{staticClass:"fixBottom"},[a("div",{staticClass:"right"},[a("el-pagination",{staticStyle:{display:"inline-block","text-align":"right"},attrs:{"current-page":t.pageIndex,"page-sizes":[10,15,20,30,50,100],layout:"total,sizes, prev, pager, next, jumper","page-count":t.pagesz,total:t.totalData},on:{"current-change":t.handleCurrentChange,"size-change":t.sizeChange}})],1)])],1),a("el-dialog",{attrs:{title:"编辑短信",visible:t.dialogEditVisible,width:"424px"},on:{"update:visible":function(e){t.dialogEditVisible=e}}},[a("el-form",[a("el-form-item",[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},model:{value:t.editTextarea,callback:function(e){t.editTextarea=e},expression:"editTextarea"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogEditVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitChange()}}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"回访编辑",visible:t.dialogReviewVisible,width:"424px"},on:{"update:visible":function(e){t.dialogReviewVisible=e}}},[a("el-form",[a("el-form-item",{attrs:{label:"通知人","label-width":"60px"}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.tzr,callback:function(e){t.tzr=e},expression:"tzr"}})],1),a("el-form-item",{attrs:{label:"受检人","label-width":"60px"}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.sjr,callback:function(e){t.sjr=e},expression:"sjr"}})],1),a("el-form-item",{attrs:{label:"回访内容","label-width":"60px"}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},model:{value:t.hfnr,callback:function(e){t.hfnr=e},expression:"hfnr"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogReviewVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.postReview()}}},[t._v("确 定")])],1)],1)],1)},n=[],l=(a("ac6a"),a("4be7")),s={name:"FJDanger",data:function(){return{name:"",keyStr:"",visitState:"false",sendFlag:"0",editTextarea:"",choosedObj:{},tfDate:[new Date((new Date).getTime()-7776e6),new Date],dialogEditVisible:!1,dialogReviewVisible:!1,hfInnerCode:"",tzr:"",sjr:"",hfnr:"",pageSize:10,pageIndex:1,pagesz:1,tableData:[],loading:!0,totalData:0,multipleSelection:[],pickerOptions2:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},editContent:""}},created:function(){this.getUser()},methods:{handleClick:function(){this.pageIndex=1,this.getUser()},sizeChange:function(t){this.pageSize=t,this.getUser()},handleCurrentChange:function(t){this.pageIndex=t,this.getUser()},getUser:function(){this.loading=!0;var t={};t.pageIndex=this.pageIndex,t.pageSize=this.pageSize,t.startDate=null==this.tfDate?null:this.tfDate[0],t.endDate=null==this.tfDate?null:this.tfDate[1],t.visitState=this.visitState,""!=this.keyStr&&(t.keyStr=this.keyStr);var e=this;this.$axios.post(this.$api.GetCrisis,t).then(function(t){e.loading=!1,1==t.data.status&&0!=t.data.entity.resultData.length?(console.log(t.data.entity.resultData),e.tableData=t.data.entity.resultData,e.pagesz=t.data.entity.totalPages,e.totalData=t.data.entity.totalCount):e.tableData=[]}).catch(function(t){e.tableData=[],e.$message.error("错误：".concat(t))})},handleSelectionChange:function(t){this.multipleSelection=t},edit:function(t,e){this.choosedObj=t,this.dialogEditVisible=!0,this.editTextarea=t.smsContent},submitChange:function(){var t=this,e=this,a=new l["Promise"](function(a,i){e.$axios.post(t.$api.UpdateSmsContent,{innerCode:e.choosedObj.smsContentInnerCode,smsConetnt:t.editTextarea}).then(function(t){1==t.data.status?(e.$message.success("修改成功"),e.getUser(),e.dialogEditVisible=!1,a(!0)):(e.$message.error("错误：".concat(t.data.message)),i(!1))}).catch(function(t){e.$message.error("错误：".concat(t)),i(!1)})});return a},sendMessage:function(){var t=this,e=[];this.multipleSelection.forEach(function(t,a){e.push(t.innerCode)});var a=this,i=new l["Promise"](function(i,n){a.$axios.post(t.$api.SendCrisisSms,{innerCode:e}).then(function(t){1==t.data.status?(a.$message.success("发送成功"),a.getUser(),i(!0)):(a.$message.error("错误：".concat(t.data.message)),n(!1))}).catch(function(t){a.$message.error("错误：".concat(t)),n(!1)})});return i},review:function(t,e){this.dialogReviewVisible=!0,this.hfInnerCode=t.innerCode,this.sjr=t.respondents,this.tzr=t.visitPerson,this.hfnr=t.respondents},postReview:function(){var t=this,e=this,a=new l["Promise"](function(a,i){e.$axios.post(t.$api.SaveVisitConent,{innerCode:t.hfInnerCode,visitContent:t.hfnr,visitPerson:t.tzr,respondents:t.sjr}).then(function(t){e.dialogReviewVisible=!1,1==t.data.status?(e.$message.success("发送成功"),e.getUser(),a(!0)):(e.$message.error("错误：".concat(t.data.message)),i(!1))}).catch(function(t){e.$message.error("错误：".concat(t)),i(!1)})});return a}}},o=s,r=(a("f9df"),a("2877")),c=Object(r["a"])(o,i,n,!1,null,null,null);c.options.__file="FJDanger.vue";e["default"]=c.exports},"82b2":function(t,e,a){},f9df:function(t,e,a){"use strict";var i=a("82b2"),n=a.n(i);n.a}}]);