(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d6b269f6"],{"06a0":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"dialoggroup"}},[a("el-dialog",{attrs:{title:"团检订单",visible:e.dialogGroupFormVisible,"close-on-click-modal":!1,width:"900px"},on:{"update:visible":function(t){e.dialogGroupFormVisible=t},open:e.showData}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"el-input__icon el-icon-arrow-left",style:{display:e.ifShow}}),a("span",[e._v("团检订单")])]),a("div",{staticClass:"customerName"},[a("section",{staticClass:"sec1"},[a("span",[e._v("单位名称：")]),a("span",[e._v(e._s(e.groupname))])]),a("section",{staticClass:"sec2"},[a("span",[e._v("交易总金额：")]),a("span",[e._v("￥"+e._s(e.allmoney)+"元")])])]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"default-sort":{prop:"date",order:"descending"}}},[a("el-table-column",{attrs:{prop:"customerName",label:"客户姓名",width:"100",sortable:""}}),a("el-table-column",{attrs:{prop:"sex",label:"性别",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.sex))])]}}])}),a("el-table-column",{attrs:{prop:"deptName",label:"部门",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.deptName))])]}}])}),a("el-table-column",{attrs:{prop:"cardNum",label:"体检卡号",width:"100",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.cardNum))])]}}])}),a("el-table-column",{attrs:{prop:"unitPayMoney",label:"单位支付金额",width:"150",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("￥ "+e._s(t.row.unitPayMoney))])]}}])}),a("el-table-column",{attrs:{prop:"personPayMoney",label:"个人支付金额",width:"150",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("￥ "+e._s(t.row.personPayMoney))])]}}])}),a("el-table-column",{attrs:{prop:"checkBeginTime",label:"到检时间",width:"100",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatDate")(t.row.checkBeginTime,"YYYY-MM-DD")))])]}}])}),a("el-table-column",{attrs:{prop:"checkFinishTime",width:"150",label:"体检结束时间",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatDate")(t.row.checkFinishTime,"YYYY-MM-DD")))])]}}])}),a("el-table-column",{attrs:{prop:"summaryFinishTime",label:"报告回传时间",width:"150",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatDate")(t.row.summaryFinishTime,"YYYY-MM-DD")))])]}}])}),a("el-table-column",{attrs:{prop:"tradeMoney",label:"操作",sortable:"",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.getDetail(t.row,t.$index)}}},[e._v("详情")])]}}])})],1)],1),a("dialoggroupjy",{ref:"dialoggroupjy",attrs:{name:e.customerName}})],1)},i=[],n=(a("cadf"),a("551c"),a("097d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"dialoggroupjy"}},[a("el-dialog",{attrs:{title:"个检订单",visible:e.dialogGroupJYVisible,"close-on-click-modal":!1,width:"900px"},on:{"update:visible":function(t){e.dialogGroupJYVisible=t},open:e.showData}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"el-input__icon el-icon-arrow-left",on:{click:e.goBack}}),a("span",[e._v("个检订单")])]),a("div",{staticClass:"customerName"},[a("section",{staticClass:"sec1"},[a("span",[e._v("客户姓名：")]),a("span",[e._v(e._s(e.name))])]),a("section",{staticClass:"sec2"},[a("span",[e._v("交易总金额：")]),a("span",[e._v("￥"+e._s(e.allmoney)+"元")])])]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"default-sort":{prop:"date",order:"descending"}}},[a("el-table-column",{attrs:{prop:"itemName",label:"项目名称",sortable:""}}),a("el-table-column",{attrs:{prop:"originalPrice",label:"原价",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("￥"+e._s(t.row.originalPrice))])]}}])}),a("el-table-column",{attrs:{prop:"discountMoney",label:"折扣",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("￥"+e._s(t.row.discountMoney))])]}}])}),a("el-table-column",{attrs:{prop:"tradeMoney",label:"现价",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("￥"+e._s(t.row.tradeMoney))])]}}])})],1)],1)],1)}),s=[],l={name:"dialoggroupjy",props:["name"],data:function(){return{dialogGroupJYVisible:!1,tradeCode:"",allmoney:0,tableData:[],QueryItems:"",OrderType:"",orderCode:"",options:[],loading:!0}},methods:{showData:function(){var e=this;this.$axios.get(this.$api.TransactionDetailItemsQueryByUnit,{params:{tradeCode:this.tradeCode,orderCode:this.orderCode}}).then(function(t){e.loading=!1,1==t.data.status?e.tableData=t.data.entity:e.$message.error("错误：".concat(t.data.message))}).catch(function(t){e.$message.error("错误：".concat(t))})},goBack:function(){var e=this;this.dialogGroupJYVisible=!1,setTimeout(function(){e.$parent.dialogGroupFormVisible=!0},300)}}},r=l,c=(a("29ab"),a("2877")),d=Object(c["a"])(r,n,s,!1,null,null,null);d.options.__file="DialogGroupJY.vue";var u=d.exports,p={components:{dialoggroupjy:u},name:"dialoggroup",props:["groupname"],data:function(){return{dialogGroupFormVisible:!1,tradeCode:"",ifShow:"none",allmoney:0,tableData:[],QueryItems:"",OrderType:"",options:[],customerName:"",loading:!0}},methods:{showData:function(){var e=this;this.$axios.get(this.$api.TransactionDetailQueryByUnit,{params:{tradeCode:this.tradeCode}}).then(function(t){e.loading=!1,1==t.data.status?e.tableData=t.data.entity:e.$message.error("错误：".concat(t.data.message))}).catch(function(t){e.$message.error("错误：".concat(t))})},getDetail:function(e,t){var a=this;this.dialogGroupFormVisible=!1,setTimeout(function(){a.$refs.dialoggroupjy.dialogGroupJYVisible=!0},200),this.$refs.dialoggroupjy.tradeCode=this.tradeCode,this.$refs.dialoggroupjy.orderCode=e.orderCode,this.$refs.dialoggroupjy.allmoney=e.unitPayMoney,this.customerName=e.customerName}}},m=p,f=(a("ad81"),Object(c["a"])(m,o,i,!1,null,null,null));f.options.__file="DialogGroup.vue";t["a"]=f.exports},"0a90":function(e,t,a){var o=a("63b6"),i=a("10ff");o(o.G+o.F*(parseFloat!=i),{parseFloat:i})},"10b4":function(e,t,a){},"10ff":function(e,t,a){var o=a("e53d").parseFloat,i=a("a1ce").trim;e.exports=1/o(a("e692")+"-0")!==-1/0?function(e){var t=i(String(e),3),a=o(t);return 0===a&&"-"==t.charAt(0)?-0:a}:o},"29ab":function(e,t,a){"use strict";var o=a("6a54"),i=a.n(o);i.a},"31a0":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content SFJYManage"},[a("div",{staticStyle:{flex:"1",overflow:"hidden",display:"flex","flex-direction":"column"}},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"收费管理",name:"first"}},[a("div",{staticClass:"peopleData",on:{keyup:function(t){return"button"in t||13===t.keyCode?e.getUser(t):null}}},[a("div",{staticClass:"propleSearch"},[a("el-input",{staticClass:"arcRadius",staticStyle:{width:"150px"},attrs:{placeholder:"请搜索"},model:{value:e.tradeName1,callback:function(t){e.tradeName1=t},expression:"tradeName1"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),a("el-select",{staticStyle:{width:"150px",display:"inline-block","margin-left":"10px"},attrs:{filterable:"",placeholder:"业务类型"},model:{value:e.typecode1,callback:function(t){e.typecode1=t},expression:"typecode1"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})],2),a("div",{staticStyle:{display:"inline-block",margin:"0 16px"}},[a("span",[e._v("入库时间：")]),a("el-date-picker",{attrs:{type:"datetimerange","picker-options":e.pickerOptions2,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:e.tfDate1,callback:function(t){e.tfDate1=t},expression:"tfDate1"}})],1),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.getUser()}}},[e._v("查询")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"default-sort":{prop:"date",order:"descending"}}},[a("el-table-column",{attrs:{type:"index",label:"序号"}}),a("el-table-column",{attrs:{prop:"tradeName",label:"客户姓名"}}),a("el-table-column",{attrs:{prop:"idCardNum",label:"身份证号",sortable:"",width:"200"}}),a("el-table-column",{attrs:{prop:"cardNum",label:"体检卡号"}}),a("el-table-column",{attrs:{prop:"tradeType",label:"业务类型",sortable:"",formatter:e.type,width:"200"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatDate")(t.row.createTime)))]}}])}),a("el-table-column",{attrs:{prop:"tradeMoney",label:"缴费金额"}}),a("el-table-column",{attrs:{label:"操作",width:"150",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.watch(t.row,t.$index)}}},[e._v("详情")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.pay(t.row,t.$index)}}},[e._v("缴费")])]}}])})],1),a("div",{staticClass:"fixBottom"},[a("div",{staticClass:"right"},[a("el-pagination",{staticStyle:{display:"inline-block","text-align":"right"},attrs:{"current-page":e.pageIndex,"page-sizes":[10,15,20,30,50,100],layout:"total,sizes, prev, pager, next, jumper","page-count":e.pagesz,total:e.totalData},on:{"current-change":e.handleCurrentChange,"size-change":e.sizeChange}})],1)])],1),a("el-tab-pane",{attrs:{label:"退费管理",name:"second"}},[a("div",{staticClass:"peopleData",on:{keyup:function(t){return"button"in t||13===t.keyCode?e.getUser(t):null}}},[a("div",{staticClass:"propleSearch"},[a("el-input",{staticClass:"arcRadius",staticStyle:{width:"150px"},attrs:{placeholder:"请搜索"},model:{value:e.tradeName,callback:function(t){e.tradeName=t},expression:"tradeName"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),a("el-select",{staticStyle:{width:"150px",display:"inline-block","margin-left":"10px"},attrs:{filterable:"",placeholder:"业务类型"},model:{value:e.typecode,callback:function(t){e.typecode=t},expression:"typecode"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})],2),a("div",{staticStyle:{display:"inline-block",margin:"0 16px"}},[a("span",[e._v("入库时间：")]),a("el-date-picker",{attrs:{type:"datetimerange","picker-options":e.pickerOptions2,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:e.tfDate,callback:function(t){e.tfDate=t},expression:"tfDate"}})],1),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.getUser()}}},[e._v("查询")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading1,expression:"loading1"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"default-sort":{prop:"date",order:"descending"}}},[a("el-table-column",{attrs:{type:"index",label:"序号"}}),a("el-table-column",{attrs:{prop:"tradeName",label:"客户姓名"}}),a("el-table-column",{attrs:{prop:"idCardNum",label:"身份证号",sortable:"",width:"200"}}),a("el-table-column",{attrs:{prop:"cardNum",label:"体检卡号"}}),a("el-table-column",{attrs:{prop:"tradeType",label:"业务类型",sortable:"",formatter:e.type}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatDate")(t.row.createTime)))]}}])}),a("el-table-column",{attrs:{prop:"tradeMoney",label:"缴费金额"}}),a("el-table-column",{attrs:{label:"操作",width:"150",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.watch(t.row,t.$index)}}},[e._v("详情")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.payBack(t.row,t.$index)}}},[e._v("退费")])]}}])})],1),a("div",{staticClass:"fixBottom"},[a("div",{staticClass:"right"},[a("el-pagination",{staticStyle:{display:"inline-block","text-align":"right"},attrs:{"current-page":e.pageIndex,"page-sizes":[10,15,20,30,50,100],layout:"total,sizes, prev, pager, next, jumper","page-count":e.pagesz,total:e.totalData},on:{"current-change":e.handleCurrentChange,"size-change":e.sizeChange}})],1)])],1)],1)],1),a("dialogjy",{ref:"dialogjy",attrs:{name:e.name}}),a("dialoggroup",{ref:"dialoggroup",attrs:{groupname:e.groupname}}),a("dialogpay",{ref:"dialogpay"}),a("dialogpayback",{ref:"dialogpayback"})],1)},i=[],n=(a("7f7f"),a("ac6a"),a("36a4")),s=a("06a0"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"dialogpay"}},[a("el-dialog",{staticClass:"infocus",attrs:{title:"缴费确认",visible:e.dialogpayVisible,width:"900px","before-close":e.unLock},on:{"update:visible":function(t){e.dialogpayVisible=t},open:e.getinit}},[a("div",{staticClass:"customerName"},[e._v("客户信息")]),a("div",{staticClass:"infomation"},[a("el-form",{ref:"form",attrs:{"label-width":"80px",inline:!0}},[a("el-form-item",{attrs:{label:"金额：","label-width":"80"}},[a("span",{staticClass:"span"},[e._v("￥"+e._s(e.money)+" 元")])]),a("el-form-item",{attrs:{label:"发票号：","label-width":"80"}},[a("span",[e._v(e._s(e.paycode))])]),a("el-form-item",{attrs:{label:"抬头：","label-width":"80"}},[a("el-input",{model:{value:e.taitou,callback:function(t){e.taitou=t},expression:"taitou"}})],1)],1)],1),a("div",{staticClass:"customerName"},[e._v("缴费方式")]),a("div",{staticClass:"paytype"},[a("el-form",{ref:"form1",attrs:{"label-width":"80px",inline:!0}},[e._l(e.MoneyDatas,function(t,o){return a("div",{key:o,staticClass:"typecontainer"},[a("el-form-item",{attrs:{label:""}},[[a("el-select",{staticClass:"inputselect",attrs:{placeholder:"缴费方式"},on:{change:function(t){e.changePay(t,o)}},model:{value:t.values,callback:function(a){e.$set(t,"values",a)},expression:"item.values"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1)]],2),a("el-form-item",[a("el-input",{staticClass:"inputtxt",on:{focus:function(t){e.getPrice(t,o)}},model:{value:t.moneycount,callback:function(a){e.$set(t,"moneycount",a)},expression:"item.moneycount"}})],1),a("el-form-item",[a("span",[e._v(" 元")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.ifshow,expression:"item.ifshow"}],staticClass:"mgleft"},[e._v("确认")])],1)],1)}),a("div",{staticClass:"typecontainer"},[a("el-form-item",[a("el-button",{staticClass:"btnplain",attrs:{plain:""},on:{click:e.addNewPay}},[e._v("+")])],1)],1)],2)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.unLock}},[e._v("取 消")]),a("el-button",[e._v("打印发票")]),a("el-button",{attrs:{type:"primary"},on:{click:e.goPay}},[e._v("确定缴费")])],1)])],1)},r=[],c=a("59ad"),d=a.n(c),u={name:"dialogpay",data:function(){return{dialogpayVisible:!1,money:0,paycode:0,tradeCode:"",OperatorCode:"001",taitou:"上海颐键",tradeType:"",formLabelWidth:"120px",options:[],MoneyDatas:[]}},mounted:function(){},methods:{ReturnPaidTypeEnum:function(){var e=this;this.$axios.get(this.$api.ReturnPaidTypeEnum).then(function(t){1==t.data.status?e.options=t.data.entity:e.$message.error("错误：".concat(t.data.message))}).catch(function(t){e.$message.error("错误：".concat(t))})},getinit:function(){var e=this;this.$axios.get(this.$api.TradeLock,{params:{tradeCode:this.tradeCode,flag:!0}}).then(function(t){1==t.data.status||(e.$message.error("错误：".concat(t.data.message)),e.dialogpayVisible=!1)}).catch(function(t){e.$message.error("错误：".concat(t))}),this.MoneyDatas=[];var t={values:1};t.moneycount=this.money,t.ifshow=!1,this.MoneyDatas.push(t),this.ReturnPaidTypeEnum(),this.$axios.get(this.$api.MINInvoiceQuery).then(function(t){1==t.data.status?e.paycode=t.data.entity:e.$message.error("错误：".concat(t.data.message))}).catch(function(t){e.$message.error("错误：".concat(t))})},unLock:function(){var e=this;e.dialogpayVisible=!1,this.$axios.get(this.$api.TradeLock,{params:{tradeCode:this.tradeCode,flag:!1}}).then(function(t){1==t.data.status||e.$message.error("错误：".concat(t.data.message))}).catch(function(t){e.$message.error("错误：".concat(t))})},addNewPay:function(){var e={values:1,moneycount:0,ifshow:!1};this.MoneyDatas.push(e)},changePay:function(e,t){this.MoneyDatas[t].ifshow=6==e||7==e},getPrice:function(e,t){var a=this.money;this.MoneyDatas.forEach(function(e,o){"number"!=typeof e.moneycount&&"string"!=typeof e.moneycount||o==t||(a-=d()(e.moneycount))}),this.MoneyDatas[t].moneycount=a},goPay:function(){var e=0;if(this.MoneyDatas.forEach(function(t,a){e+=d()(t.moneycount)}),e==this.money){var t=this,a=[],o=[];o=this.MoneyDatas.filter(function(e){return 0!=e.moneycount}),o.forEach(function(e,t){var o={};0!=e.moneycount&&(o.TypeCode=e.values,o.TradeMoney=e.moneycount),a.push(o)}),this.$axios.post(this.$api.TransactionOK,{TradeCode:t.tradeCode,Type:t.tradeType,TradeTypes:a,OperatorCode:t.OperatorCode,RefundInvoiceNum:""}).then(function(e){1==e.data.status?1==e.data.entity&&(t.$message.success("缴费成功"),t.$parent.getUser(),t.dialogpayVisible=!1):t.$message.error("错误：".concat(e.data.message))}).catch(function(e){t.$message.error("错误：".concat(e))})}else this.$message.error("相加金额不等，请重新计算")}}},p=u,m=(a("d84c"),a("2877")),f=Object(m["a"])(p,l,r,!1,null,"56765508",null);f.options.__file="DialogPay.vue";var y=f.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"infocus"}},[a("el-dialog",{staticClass:"infocus",attrs:{title:"退费确认",visible:e.dialogPayBackVisible,width:"900px","before-close":e.unLock},on:{"update:visible":function(t){e.dialogPayBackVisible=t},open:e.getinit}},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"退费信息",name:"first"}},[a("div",{staticClass:"infomation"},[a("el-form",{ref:"form",attrs:{inline:!0}},[a("el-form-item",{staticClass:"firstline",attrs:{label:"退费金额："}},[a("span",{staticClass:"span"},[e._v("￥"+e._s(Math.abs(e.money))+" 元")])]),a("el-form-item",{attrs:{label:"作废发票：","label-width":"80"}},[a("el-select",{staticStyle:{"margin-left":"20px",width:"220px"},attrs:{multiple:"","collapse-tags":"",placeholder:"请选择"},on:{change:e.getMoney},model:{value:e.value11,callback:function(t){e.value11=t},expression:"value11"}},e._l(e.optionItems,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.fapiao}})}),1)],1),a("el-form-item",{attrs:{label:"发票金额：","label-width":"80"}},[a("span",[e._v(e._s(Math.abs(e.selectedMoney))+" 元")])])],1)],1),a("div",{staticClass:"customerName"},[e._v("客户信息")]),a("div",{staticClass:"infomation"},[a("el-form",{ref:"form",attrs:{"label-width":"80px",inline:!0}},[a("el-form-item",{attrs:{label:"新开发票号：","label-width":"80"}},[a("span",[e._v(e._s(e.paycode))])]),a("el-form-item",{attrs:{label:"发票金额：","label-width":"80"}},[a("span",[e._v("￥"+e._s(e.printMoney)+" 元")])]),a("el-form-item",{attrs:{label:"抬头：","label-width":"80"}},[a("el-input",{model:{value:e.taitou,callback:function(t){e.taitou=t},expression:"taitou"}})],1)],1)],1),a("div",{staticClass:"customerName"},[e._v("退费方式")]),a("div",{staticClass:"paytype"},[a("el-form",{ref:"form1",attrs:{"label-width":"80px",inline:!0}},[e._l(e.MoneyDatas,function(t,o){return a("div",{key:o,staticClass:"typecontainer"},[a("el-form-item",{attrs:{label:""}},[[a("el-select",{staticClass:"inputselect",attrs:{placeholder:"退费方式"},model:{value:t.values,callback:function(a){e.$set(t,"values",a)},expression:"item.values"}},e._l(e.options,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})}),1)]],2),a("el-form-item",[a("el-input",{staticClass:"inputtxt",attrs:{placeholder:t.moneycount},on:{blur:function(t){e.comparePrice(o)}},model:{value:t.init,callback:function(a){e.$set(t,"init",a)},expression:"item.init"}})],1),a("el-form-item",[a("span",[e._v(" 元")])])],1)}),a("div",{staticClass:"typecontainer"},[a("el-form-item",[a("el-button",{staticClass:"btnplain",attrs:{plain:""},on:{click:e.addNewPay}},[e._v("+")])],1)],1)],2)],1)]),a("el-tab-pane",{attrs:{label:"支付信息",name:"second"}},[a("el-row",[a("el-col",{staticClass:"modal-con lht",attrs:{span:3}},[e._v("订单金额：")]),a("el-col",{staticClass:"modal-con",attrs:{span:21}},[a("div",[a("ul",[a("li",{staticClass:"item"},[a("span",[e._v("金额：")]),a("div",[e._v("￥"+e._s(e.paidMoney)+"元")])])])])])],1),a("el-row",[a("el-col",{staticClass:"modal-con lht",attrs:{span:3}},[e._v("支付详情：")]),a("el-col",{staticClass:"modal-con",attrs:{span:21}},e._l(e.MoneyDatas,function(t,o){return a("div",{key:o},[a("ul",[a("li",{staticClass:"item"},[a("span",[e._v("支付方式：")]),a("div",[e._v(e._s(t.hanzi))])]),a("li",{staticClass:"item"},[a("span",[e._v("支付金额：￥"+e._s(t.moneycount)+"元")]),a("div")])])])}),0)],1),a("el-row",[a("el-col",{staticClass:"modal-con lht",attrs:{span:3}},[e._v("发票列表：")]),a("el-col",{staticClass:"modal-con",attrs:{span:21}},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.usedInvoices,"default-sort":{prop:"date",order:"descending"}}},[a("el-table-column",{attrs:{prop:"usedTime",label:"开票时间",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatDate")(t.row.usedTime,"YYYY-MM-DD")))])]}}])}),a("el-table-column",{attrs:{prop:"invoiceMoney",label:"发票金额",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("￥"+e._s(t.row.invoiceMoney))])]}}])}),a("el-table-column",{attrs:{prop:"accountName",label:"抬头",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.accountName))])]}}])}),a("el-table-column",{attrs:{prop:"invoiceNum",label:"发票号",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.invoiceNum))])]}}])})],1)],1)],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.unLock}},[e._v("取 消")]),a("el-button",[e._v("打印发票")]),a("el-button",{attrs:{type:"primary"},on:{click:e.goPay}},[e._v("确定缴费")])],1)],1)],1)},h=[],b={name:"dialogpay",data:function(){return{activeName:"first",dialogPayBackVisible:!1,money:0,paycode:0,tradeCode:"",OperatorCode:"001",orderCode:"",taitou:"上海颐键",value11:[],tradeType:"",formLabelWidth:"120px",options:[],MoneyDatas:[],optionItems:[],selectedMoney:0,printMoney:0,paidMoney:0,usedInvoices:[]}},methods:{ReturnPaidTypeEnum:function(){var e=this;this.$axios.get(this.$api.ReturnPaidTypeEnum).then(function(t){1==t.data.status?e.options=t.data.entity:e.$message.error("错误：".concat(t.data.message))}).catch(function(t){e.$message.error("错误：".concat(t))})},handleClick:function(){},getinit:function(){var e=this;this.$axios.get(this.$api.TradeLock,{params:{tradeCode:this.tradeCode,flag:!0}}).then(function(t){1==t.data.status||(e.$message.error("错误：".concat(t.data.message)),e.dialogPayBackVisible=!1)}).catch(function(t){e.$message.error("错误：".concat(t))}),this.MoneyDatas=[],this.ReturnPaidTypeEnum(),this.$axios.get(this.$api.RefundTradeMessageQuery,{params:{orderCode:e.orderCode}}).then(function(t){if(console.log(t.data),1==t.data.status){if(0!=t.data.entity.paidTypes.length&&t.data.entity.paidTypes.forEach(function(t){var a={};a.values=t.paidType,a.moneycount=t.tradeMoney,a.init="",a.hanzi="",e.options.forEach(function(e){t.paidType==e.value&&(a.hanzi=e.name)}),e.MoneyDatas.push(a),console.log(e.MoneyDatas)}),0!=t.data.entity.usedInvoices.length){e.usedInvoices=t.data.entity.usedInvoices;var a=[];t.data.entity.usedInvoices.forEach(function(t,o){0==o&&(e.value11.push(t.invoiceNum),e.selectedMoney=t.invoiceMoney,e.printMoney=d()(e.money)+d()(e.selectedMoney));var i={};i.label=t.invoiceNum+"  ￥"+t.invoiceMoney+"元",i.money=t.invoiceMoney,i.fapiao=t.invoiceNum,a.push(i)}),e.optionItems=a}e.paycode=t.data.entity.invoiceNum,e.paidMoney=t.data.entity.paidMoney}else e.$message.error("错误：".concat(t.data.message))}).catch(function(t){e.$message.error("错误：".concat(t))})},unLock:function(){var e=this;e.dialogPayBackVisible=!1,this.$axios.get(this.$api.TradeLock,{params:{tradeCode:this.tradeCode,flag:!1}}).then(function(t){1==t.data.status||e.$message.error("错误：".concat(t.data.message))}).catch(function(t){e.$message.error("错误：".concat(t))})},addNewPay:function(){var e={values:"",moneycount:0,init:"",hanzi:""};this.MoneyDatas.push(e)},comparePrice:function(e){"-1"!=this.MoneyDatas[e].init.indexOf("-")&&(this.$message.error("金额必须为正值，请重新输入"),this.MoneyDatas[e].init=""),d()(this.MoneyDatas[e].init)>d()(this.MoneyDatas[e].moneycount)&&(this.$message.error("输入金额不能大于付款金额，请重新输入"),this.MoneyDatas[e].init="")},goPay:function(){var e=0,t=this;if(this.MoneyDatas.forEach(function(t,a){e+=d()(Math.abs(t.init))}),0!=t.value11.length)if(Math.abs(d()(e))==Math.abs(this.money)){var a=[],o=[];o=this.MoneyDatas.filter(function(e){return 0!=e.init&&""!=e.init}),o.forEach(function(e,t){var o={};0!=e.moneycount&&(o.TypeCode=e.values,o.TradeMoney=d()("-"+Math.abs(e.init))),a.push(o)}),this.$axios.post(this.$api.TransactionOK,{TradeCode:t.tradeCode,Type:t.tradeType,TradeTypes:a,OperatorCode:t.OperatorCode,RefundInvoiceNum:t.value11}).then(function(e){1==e.data.status?1==e.data.entity&&(t.$message.success("退费成功"),t.dialogPayBackVisible=!1):t.$message.error("错误：".concat(e.data.message))}).catch(function(e){t.$message.error("错误：".concat(e))})}else this.$message.error("相加金额不等，请重新计算");else this.$message.error("至少选择一张作废发票")},getMoney:function(){var e=this;e.selectedMoney=0,this.value11.forEach(function(t){e.optionItems.forEach(function(a){a.fapiao==t&&(e.selectedMoney+=d()(a.money))})})}}},v=b,_=(a("b10c"),Object(m["a"])(v,g,h,!1,null,"9ee06062",null));_.options.__file="DialogPayBack.vue";var C=_.exports,k=(a("4be7"),{name:"SFJYManage",data:function(){return{name:"",groupname:"",tradeName:"",activeName:"first",tfDate:[new Date((new Date).getTime()-2592e6),new Date],typecode:"",tradeName1:"",tfDate1:[new Date((new Date).getTime()-2592e6),new Date],typecode1:"",pageSize:10,pageIndex:1,pagesz:1,tableData:[],loading:!0,loading1:!0,totalData:0,pickerOptions2:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},options:[]}},created:function(){this.getUser(),this.getEunmType()},methods:{handleClick:function(){this.pageIndex=1,this.getUser()},sizeChange:function(e){this.pageSize=e,this.getUser()},handleCurrentChange:function(e){this.pageIndex=e,this.getUser()},getUser:function(){this.loading=!0,this.loading1=!0;var e=this;"first"==e.activeName?(console.log(this.tfDate1),this.$axios.get(this.$api.TransactionQuery,{params:{pageIndex:this.pageIndex,pageSize:this.pageSize,BeginTime:null==this.tfDate1?null:this.tfDate1[0],EndTime:null==this.tfDate1?null:this.tfDate1[1],TradeName:this.tradeName1,TimeType:1,TradeType:this.typecode1,TradeStatus:0,TradeForm:1}}).then(function(t){console.log(t.data.entity),e.loading=!1,1==t.data.status?(e.tableData=t.data.entity.tradeMessages,e.pagesz=t.data.entity.pageNum,e.totalData=t.data.entity.dataNum):e.$message.error("错误：".concat(t.data.message))}).catch(function(t){e.$message.error("错误：".concat(t))})):this.$axios.get(this.$api.TransactionQuery,{params:{pageIndex:this.pageIndex,pageSize:this.pageSize,BeginTime:null==this.tfDate?null:this.tfDate[0],EndTime:null==this.tfDate?null:this.tfDate[1],TradeName:this.tradeName,TimeType:1,TradeType:this.typecode,TradeStatus:0,TradeForm:2}}).then(function(t){e.loading1=!1,1==t.data.status?(e.tableData=t.data.entity.tradeMessages,e.pagesz=t.data.entity.pageNum,e.totalData=t.data.entity.dataNum):(e.tableData=[],e.$message.error("错误：".concat(t.data.message)))}).catch(function(t){e.tableData=[],e.$message.error("错误：".concat(t))})},watch:function(e,t){this.name=e.tradeName,this.groupname=e.tradeName,1==e.tradeType?(this.$refs.dialogjy.dialogFormVisible=!0,this.$refs.dialogjy.tradeCode=e.tradeCode,this.$refs.dialogjy.allmoney=e.tradeMoney):2==e.tradeType&&(this.$refs.dialoggroup.dialogGroupFormVisible=!0,this.$refs.dialoggroup.tradeCode=e.tradeCode,this.$refs.dialoggroup.allmoney=e.tradeMoney)},pay:function(e,t){1==e.tradeType?this.$refs.dialogpay.tradeType=1:2==e.tradeType&&(this.$refs.dialogpay.tradeType=2),this.$refs.dialogpay.dialogpayVisible=!0,this.$refs.dialogpay.tradeCode=e.tradeCode,this.$refs.dialogpay.money=e.tradeMoney,this.$refs.dialogpay.taitou=e.tradeName},payBack:function(e,t){1==e.tradeType?(this.$refs.dialogpayback.tradeType=1,this.$refs.dialogpayback.orderCode=e.orderCode):2==e.tradeType&&(this.$refs.dialogpayback.tradeType=2,this.$refs.dialogpayback.orderCode=e.grpOrderCode),this.$refs.dialogpayback.dialogPayBackVisible=!0,this.$refs.dialogpayback.tradeCode=e.tradeCode,this.$refs.dialogpayback.money=e.tradeMoney,this.$refs.dialogpayback.taitou=e.tradeName},getEunmType:function(){var e=this;this.$axios.get(this.$api.ReturnTradeTypeEnum).then(function(t){1==t.data.status?e.options=t.data.entity:e.$message.error("错误：".concat(t.data.message))}).catch(function(t){e.$message.error("错误：".concat(t))})},type:function(e,t){var a;return this.options.forEach(function(t,o){t.value==e.tradeType&&(a=t.name)}),a}},components:{dialogjy:n["a"],dialoggroup:s["a"],dialogpay:y,dialogpayback:C}}),w=k,x=(a("6922"),Object(m["a"])(w,o,i,!1,null,"1066c970",null));x.options.__file="SFJYManage.vue";t["default"]=x.exports},"36a4":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"dialogjy"}},[a("el-dialog",{attrs:{title:"个检订单",visible:e.dialogFormVisible,"close-on-click-modal":!1,width:"900px"},on:{"update:visible":function(t){e.dialogFormVisible=t},open:e.showData}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"el-input__icon el-icon-arrow-left",style:{display:e.ifShow}}),a("span",[e._v("个检订单")])]),a("div",{staticClass:"customerName"},[a("section",{staticClass:"sec1"},[a("span",[e._v("客户姓名：")]),a("span",[e._v(e._s(e.name))])]),a("section",{staticClass:"sec2"},[a("span",[e._v("交易总金额：")]),a("span",[e._v("￥"+e._s(e.allmoney)+"元")])])]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"default-sort":{prop:"date",order:"descending"}}},[a("el-table-column",{attrs:{prop:"itemName",label:"项目名称",sortable:""}}),a("el-table-column",{attrs:{prop:"originalPrice",label:"原价",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("￥"+e._s(t.row.originalPrice))])]}}])}),a("el-table-column",{attrs:{prop:"discountMoney",label:"折扣",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("￥"+e._s(t.row.discountMoney))])]}}])}),a("el-table-column",{attrs:{prop:"tradeMoney",label:"现价",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("￥"+e._s(t.row.tradeMoney))])]}}])})],1)],1)],1)},i=[],n=(a("cadf"),a("551c"),a("097d"),{name:"dialogjy",props:["name"],data:function(){return{dialogFormVisible:!1,tradeCode:"",ifShow:"none",allmoney:0,tableData:[],QueryItems:"",OrderType:"",options:[],loading:!0}},methods:{showData:function(){var e=this;this.$axios.get(this.$api.TransactionDetailQueryByPerson,{params:{tradeCode:this.tradeCode}}).then(function(t){e.loading=!1,1==t.data.status?e.tableData=t.data.entity:e.$message.error("错误：".concat(t.data.message))}).catch(function(t){e.$message.error("错误：".concat(t))})}}}),s=n,l=(a("b828"),a("2877")),r=Object(l["a"])(s,o,i,!1,null,null,null);r.options.__file="DialogJY.vue";t["a"]=r.exports},5460:function(e,t,a){},"59ad":function(e,t,a){e.exports=a("7be7")},6922:function(e,t,a){"use strict";var o=a("6963"),i=a.n(o);i.a},6963:function(e,t,a){},"6a54":function(e,t,a){},"7be7":function(e,t,a){a("0a90"),e.exports=a("584a").parseFloat},9484:function(e,t,a){},a1ce:function(e,t,a){var o=a("63b6"),i=a("25eb"),n=a("294c"),s=a("e692"),l="["+s+"]",r="​",c=RegExp("^"+l+l+"*"),d=RegExp(l+l+"*$"),u=function(e,t,a){var i={},l=n(function(){return!!s[e]()||r[e]()!=r}),c=i[e]=l?t(p):s[e];a&&(i[a]=c),o(o.P+o.F*l,"String",i)},p=u.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(d,"")),e};e.exports=u},ad81:function(e,t,a){"use strict";var o=a("9484"),i=a.n(o);i.a},b10c:function(e,t,a){"use strict";var o=a("10b4"),i=a.n(o);i.a},b34f:function(e,t,a){},b828:function(e,t,a){"use strict";var o=a("b34f"),i=a.n(o);i.a},d84c:function(e,t,a){"use strict";var o=a("5460"),i=a.n(o);i.a},e692:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);