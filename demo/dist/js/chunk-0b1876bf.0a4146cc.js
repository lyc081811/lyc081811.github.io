(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b1876bf"],{"4dfb":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content MGManage"},[a("div",{staticClass:"topTitle"},[a("span",[e._v("报告管理")]),a("div",{staticClass:"right"},[a("el-button",{on:{click:e.reportPrint}},[e._v("生成报告")]),a("el-button",{on:{click:e.printBG}},[e._v("打印报告")]),a("el-button",{on:{click:e.batchExport}},[e._v("批量导出")]),a("el-button",{on:{click:e.sendSMS}},[e._v("发送短信")]),a("el-button",{on:{click:e.reportTake}},[e._v("领取报告")])],1)]),a("div",{staticClass:"peopleData"},[a("div",{staticClass:"propleSearch"},[a("el-input",{staticClass:"arcRadius",staticStyle:{width:"150px"},attrs:{placeholder:"请搜索"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getData(!0)}},model:{value:e.params.Condition,callback:function(t){e.$set(e.params,"Condition",t)},expression:"params.Condition"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),a("el-select",{attrs:{placeholder:"是否打印",clearable:""},model:{value:e.params.IfPrint,callback:function(t){e.$set(e.params,"IfPrint",t)},expression:"params.IfPrint"}},[a("el-option",{attrs:{label:"是",value:!0}}),a("el-option",{attrs:{label:"否",value:!1}})],1),a("el-select",{attrs:{placeholder:"是否导出",clearable:""},model:{value:e.params.IfExport,callback:function(t){e.$set(e.params,"IfExport",t)},expression:"params.IfExport"}},[a("el-option",{attrs:{label:"是",value:!0}}),a("el-option",{attrs:{label:"否",value:!1}})],1),a("el-select",{attrs:{placeholder:"是否生成",clearable:""},model:{value:e.params.IfMark,callback:function(t){e.$set(e.params,"IfMark",t)},expression:"params.IfMark"}},[a("el-option",{attrs:{label:"是",value:!0}}),a("el-option",{attrs:{label:"否",value:!1}})],1),a("el-select",{attrs:{placeholder:"是否发送短信",clearable:""},model:{value:e.params.IfSend,callback:function(t){e.$set(e.params,"IfSend",t)},expression:"params.IfSend"}},e._l(e.sendStatus,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1),a("el-select",{attrs:{placeholder:"时间类型",clearable:""},model:{value:e.params.TimeType,callback:function(t){e.$set(e.params,"TimeType",t)},expression:"params.TimeType"}},e._l(e.reportTimeTypes,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1),a("div",{staticStyle:{display:"inline-block",margin:"0 16px"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.params.timeRange,callback:function(t){e.$set(e.params,"timeRange",t)},expression:"params.timeRange"}})],1),a("el-button",{on:{click:function(t){e.getData(!0)}}},[e._v("查询")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"row-click":e.clickRow2,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),a("el-table-column",{attrs:{prop:"customerName",label:"姓名"}}),a("el-table-column",{attrs:{prop:"sex",label:"性别"}}),a("el-table-column",{attrs:{prop:"cardNum",label:"体检卡号"}}),a("el-table-column",{attrs:{prop:"idCardNum",label:"身份证号"}}),a("el-table-column",{attrs:{prop:"tele",label:"手机号"}}),a("el-table-column",{attrs:{prop:"unitName",label:"单位"}}),a("el-table-column",{attrs:{prop:"deptName",label:"部门"}}),a("el-table-column",{attrs:{prop:"createTime",label:"生成时间"}}),a("el-table-column",{attrs:{prop:"ifTake",label:"领取"}}),a("el-table-column",{attrs:{prop:"takeType",label:"领取方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"bottom"}},[a("p",[e._v("领取人: "+e._s(t.row.takerName))]),a("p",[e._v("手机号: "+e._s(t.row.takerTele))]),a("p",[e._v("身份证号: "+e._s(t.row.takerIDCardNum))]),a("p",[e._v("备注信息："+e._s(t.row.remark))]),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[e._v("\n\t\t\t\t\t\t\t"+e._s(t.row.takeType)+"\n\t\t\t\t\t\t")])])]}}])}),a("el-table-column",{attrs:{prop:"ifPrint",label:"打印"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.ifPrint)+"\n          "),"是"===t.row.ifPrint?a("span",[e._v("x"+e._s(t.row.printCount))]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"ifExport",label:"导出"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.ifExport)+"\n          "),"是"===t.row.ifExport?a("span",[e._v("x"+e._s(t.row.exportCount))]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"ifSend",label:"短信"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.preview(t.row)}}},[e._v("预览")])]}}])})],1),a("div",{staticClass:"fixBottom"},[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.toggleSelection()}}},[e._v("反选")]),a("span",{staticClass:"subitem"},[e._v("\n        合计：\n        "),a("span",{staticClass:"labelColor ftArial"},[e._v(e._s(e.tableData.length||0))])]),a("span",{staticClass:"subitem"},[e._v("\n        选中：\n        "),a("span",{staticClass:"labelColor ftArial"},[e._v(e._s(e.multipleTable.length||0))])]),a("div",{staticClass:"right"},[a("el-pagination",{attrs:{layout:"total,sizes, prev, pager, next",total:e.total,"page-sizes":[10,20,50,100],"current-page":e.searchParams.PageIndex},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1),a("el-dialog",{staticClass:"bgModal",attrs:{title:"领取报告",visible:e.getBGModal,"close-on-click-modal":!1,width:"605px"},on:{"update:visible":function(t){e.getBGModal=t}}},[a("ul",{staticClass:"modal-con"},[a("li",{staticClass:"item"},[a("span",[e._v("领取人：")]),a("div",{staticClass:"item-list"},[a("el-input",{model:{value:e.peopleInfo.TakeName,callback:function(t){e.$set(e.peopleInfo,"TakeName",t)},expression:"peopleInfo.TakeName"}})],1)]),a("li",{staticClass:"item",staticStyle:{width:"60%"}},[a("span",[e._v("身份证号：")]),a("div",{staticClass:"item-list",staticStyle:{width:"242px"}},[a("el-input",{staticStyle:{width:"150px","margin-right":"8px"},attrs:{maxlength:"18"},model:{value:e.peopleInfo.IdCardNum,callback:function(t){e.$set(e.peopleInfo,"IdCardNum",t)},expression:"peopleInfo.IdCardNum"}}),a("el-button",{staticClass:"idHandle",attrs:{type:"primary"},on:{click:e.getIdentity}},[e._v("刷身份证")])],1)]),a("li",{staticClass:"item"},[a("span",[e._v("手机号：")]),a("div",{staticClass:"item-list"},[a("el-input",{model:{value:e.peopleInfo.TakerTele,callback:function(t){e.$set(e.peopleInfo,"TakerTele",t)},expression:"peopleInfo.TakerTele"}})],1)]),a("li",{staticClass:"item",staticStyle:{width:"60%"}},[a("span",[e._v("领取方式：")]),a("div",{staticClass:"item-list",staticStyle:{width:"242px"}},[a("el-select",{staticStyle:{"padding-right":"0"},attrs:{placeholder:"订单类型"},model:{value:e.peopleInfo.takeType,callback:function(t){e.$set(e.peopleInfo,"takeType",t)},expression:"peopleInfo.takeType"}},e._l(e.takeTypes,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1)],1)]),a("li",{staticClass:"item",staticStyle:{width:"100%"}},[a("span",[e._v("备注信息：")]),a("div",{staticClass:"item-list",staticStyle:{width:"100%"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"快递方式、快递号等信息"},model:{value:e.peopleInfo.Remark,callback:function(t){e.$set(e.peopleInfo,"Remark",t)},expression:"peopleInfo.Remark"}})],1)])]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.getBGModal=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.reportTakeBtn}},[e._v("确 定")])],1)]),a("el-dialog",{staticClass:"viewModal",attrs:{title:"报告预览",visible:e.bgPreview,"close-on-click-modal":!1,width:"1000px"},on:{"update:visible":function(t){e.bgPreview=t}}},[a("div",{staticStyle:{"max-height":"500px",overflow:"auto"}},[a("img",{staticStyle:{width:"100%"},attrs:{src:"data:image/jpeg;base64,"+e.viewImg,alt:"报告预览"}})])])],1)},i=[],r=(a("ac6a"),a("c1df")),l=a.n(r),n={name:"BGManage",data:function(){return{getBGModal:!1,bgPreview:!1,viewImg:"",searchParams:{Condition:"",IfPrint:"",IfExport:"",IfMark:!0,IfSend:"",TimeType:"",BeginTime:"",EndTime:"",PageIndex:1,PageSize:10},params:{Condition:"",IfPrint:"",IfExport:"",IfMark:!0,IfSend:"",TimeType:"",BeginTime:"",EndTime:"",timeRange:[l()().add(-1,"weeks").format(),l()().format()]},peopleInfo:{TakeName:"",TakerTele:"",IdCardNum:"",TakeType:0,Remark:"",ReportCodes:[],OperatorCode:"001"},loading:!1,total:0,timeRange:[l()().add(-1,"weeks").format(),l()().format()],sendStatus:[],takeTypes:[],reportTimeTypes:[],SMSTimeTypes:[],SMSTypes:[],tableData:[],multipleTable:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]}}},created:function(){this.getTypeEnum(),this.getData(!0)},methods:{toggleSelection:function(){var e=this;this.tableData?this.tableData.forEach(function(t){e.$refs.multipleTable.toggleRowSelection(t)}):this.$refs.multipleTable.clearSelection()},getData:function(e){var t=this;this.loading=!0,e?(this.params.timeRange&&2===this.params.timeRange.length?(this.searchParams.BeginTime=l()(this.params.timeRange[0]).format("YYYY-MM-DD"),this.searchParams.EndTime=l()(this.params.timeRange[1]).format("YYYY-MM-DD")):(this.searchParams.BeginTime="",this.searchParams.EndTime=""),this.searchParams.Condition=this.params.Condition,this.searchParams.IfPrint=this.params.IfPrint,this.searchParams.IfExport=this.params.IfExport,this.searchParams.IfMark=this.params.IfMark,this.searchParams.IfSend=this.params.IfSend,this.searchParams.TimeType=this.params.TimeType,this.searchParams.PageIndex=1,this.timeRange=this.params.timeRange):(this.params.Condition=this.searchParams.Condition,this.params.IfPrint=this.searchParams.IfPrint,this.params.IfExport=this.searchParams.IfExport,this.params.IfMark=this.searchParams.IfMark,this.params.IfSend=this.searchParams.IfSend,this.params.TimeType=this.searchParams.TimeType,this.params.timeRange=this.timeRange),this.$axios.post(this.$api.ReportQuery,this.searchParams).then(function(e){1===e.data.status&&e.data.entity?(t.tableData=e.data.entity.reportMessages,t.total=e.data.entity.dataNum):t.$message.error(e.data.$message),t.loading=!1}).catch(function(e){t.loading=!1,t.$message.error(e.data.message)})},getTypeEnum:function(){var e=this;this.$getType("TakeType").then(function(t){200===t.status&&1===t.data.status&&(e.takeTypes=t.data.entity)}),this.$getType("SendStatus").then(function(t){200===t.status&&1===t.data.status&&(e.sendStatus=t.data.entity)}),this.$getType("ReportTimeType").then(function(t){200===t.status&&1===t.data.status&&(e.reportTimeTypes=t.data.entity)}),this.$getType("SMSTimeType").then(function(t){200===t.status&&1===t.data.status&&(e.SMSTimeTypes=t.data.entity)}),this.$axios.get(this.$api.ReturnSMSType).then(function(t){t.data.entity&&1===t.data.status?e.SMSTypes=t.data.entity:e.$message.error(t.data.message)}).catch(function(t){e.$message.error(t.data.message)})},reportPrint:function(){var e=this;if(0!==this.multipleTable.length){var t=[];this.multipleTable.forEach(function(e){e.orderCode&&t.push(e.orderCode)});var a=this.$message({message:"报告生成中...",duration:0});this.$axios.post(this.$api.MakeReportByReturnValue,{OrderCodes:t,OperatorCode:"001"}).then(function(t){if(1===t.data.status){e.getData();var s=t.data.entity.successCount,i=t.data.entity.errorCount,r=e.$createElement;e.$notify({title:"生成报告完成！",message:r("i",{style:"color: #606266"},"成功".concat(s,"条，失败").concat(i,"条，合计").concat(i+s,"条。"))})}else e.$message.error(t.data.message);a.close()}).catch(function(t){a.close(),e.$message.error(t.data.message)})}else this.$message.error("请选择后点击生成报告")},printBG:function(){var e=this;if(0!==this.multipleTable.length){var t=[];this.multipleTable.forEach(function(e){e.reportCode&&t.push(e.reportCode)});var a=this.$message({message:"报告打印中...",duration:0});this.$axios.post(this.$api.ReportPrint,t).then(function(t){if(1===t.data.status){e.getData();var s=t.data.entity.successCount,i=t.data.entity.errorCount,r=e.$createElement;e.$notify({title:"打印报告完成！",message:r("i",{style:"color: #606266"},"成功".concat(s,"条，失败").concat(i,"条，合计").concat(i+s,"条。"))})}else e.$message.error(t.data.message);a.close()}).catch(function(t){a.close(),e.$message.error(t.data.message)})}else this.$message.error("请选择后点击打印报告")},batchExport:function(){0!==this.multipleTable.length?alert("还没有接口"):this.$message.error("请选择后点击批量导出")},sendSMS:function(){var e=this;if(0!==this.multipleTable.length){var t=[];this.multipleTable.forEach(function(e){e.orderCode&&t.push(e.orderCode)});var a=this.$message({message:"短信发送中...",duration:0});this.$axios.post(this.$api.SendSmsModByReportQuery,{Codes:t,OperatorCode:"001"}).then(function(t){if(1===t.data.status){e.getData();var s=t.data.entity.successCount,i=t.data.entity.errorCount,r=e.$createElement;e.$notify({title:"短信发送完成！",message:r("i",{style:"color: #606266"},"成功".concat(s,"条，失败").concat(i,"条，合计").concat(i+s,"条。"))})}else e.$message.error(t.data.message);a.close()}).catch(function(t){a.close(),e.$message.error(t.data.message)})}else this.$message.error("请选择后点击发送短信")},reportTake:function(){var e=this;this.peopleInfo.ReportCodes=[],this.peopleInfo.TakeName="",this.peopleInfo.TakerTele="",this.peopleInfo.IdCardNum="",this.peopleInfo.TakeType="",this.peopleInfo.Remark="",0!==this.multipleTable.length?this.multipleTable.some(function(e){return"是"===e.ifTake})?this.$message.error("所选人员中含有已领取报告"):(this.multipleTable.forEach(function(t){t.reportCode&&e.peopleInfo.ReportCodes.push(t.reportCode)}),this.getBGModal=!0):this.$message.error("请选择后点击领取报告")},reportTakeBtn:function(){var e=this;this.peopleInfo.TakeType||(this.peopleInfo.TakeType=0),this.$axios.post(this.$api.ReportTake,this.peopleInfo).then(function(t){1===t.data.status?(e.$message.success("领取报告成功！"),e.getData(),e.getBGModal=!1):e.$message.error(t.data.message)}).catch(function(t){e.$message.error(t.data.message)})},preview:function(e){var t=this,a=[e.reportCode];this.$axios.post(this.$api.ReportPrint,a).then(function(e){1===e.data.status?(t.viewImg=e.data.entity.image64[0],t.viewImg?t.bgPreview=!0:t.$message.error("请先生成报告后预览")):t.$message.error(e.data.message)}).catch(function(e){t.$message.error(e.data.message)})},getIdentity:function(){api.getIdcard(this.setIdentity)},setIdentity:function(e){var t=JSON.parse(e);this.peopleInfo.TakeName=t.Name,this.peopleInfo.IdCardNum=t.IdcardNumNum},handleCurrentChange:function(e){this.searchParams.pageIndex=e,this.getData()},handleSizeChange:function(e){this.searchParams.PageSize=e,this.searchParams.PageIndex=1,this.getData()},clickRow2:function(e,t){"操作"!==t.label&&this.$refs.multipleTable.toggleRowSelection(e)},handleSelectionChange:function(e){this.multipleTable=e}}},o=n,p=(a("b001"),a("2877")),c=Object(p["a"])(o,s,i,!1,null,"1719ff8c",null);c.options.__file="BGManage.vue";t["default"]=c.exports},b001:function(e,t,a){"use strict";var s=a("b0be"),i=a.n(s);i.a},b0be:function(e,t,a){}}]);